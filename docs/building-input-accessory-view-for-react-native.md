Building <InputAccessoryView> For React Native · React Native

[Skip to main content](#__docusaurus_skipToContent_fallback)

Join us for React Conf on Oct 7-8. [Learn more](https://conf.react.dev).

[![React Native](/img/header_logo.svg)![React Native](/img/header_logo.svg)

**React Native**](/)

[Development](#)

* [Guides](/docs/getting-started)* [Components](/docs/components-and-apis)* [APIs](/docs/accessibilityinfo)* [Architecture](/architecture/overview)

[Contributing](/contributing/overview)[Community](/community/overview)[Showcase](/showcase)[Blog](/blog)

Search

All Blog Posts

##### 2025

* [React Native 0.79 - Faster tooling and much more](/blog/2025/04/08/react-native-0.79)* [React Native 0.78 - React 19 and more](/blog/2025/02/19/react-native-0.78)* [React Native Core Contributor Summit 2024 Recap](/blog/2025/02/03/react-native-core-contributor-summit-2024)* [React Native 0.77 - New Styling Features, Android’s 16KB page support, Swift Template](/blog/2025/01/21/version-0.77)

      ##### 2024

      * [New Architecture is here](/blog/2024/10/23/the-new-architecture-is-here)* [React Native 0.76 - New Architecture by default, React Native DevTools, and more](/blog/2024/10/23/release-0.76-new-architecture)* [React Native 0.75 - Support for Percentage Values in Layout, New Architecture Stabilization, Template & init Updates, and more](/blog/2024/08/12/release-0.75)* [Use a framework to build React Native apps](/blog/2024/06/25/use-a-framework-to-build-react-native-apps)* [React Native 0.74 - Yoga 3.0, Bridgeless New Architecture, and more](/blog/2024/04/22/release-0.74)

              ##### 2023

              * [React Native 0.73 - Debugging Improvements, Stable Symlink Support, and more](/blog/2023/12/06/0.73-debugging-improvements-stable-symlinks)* [React Native 0.72 - Symlink Support, Better Errors, and more](/blog/2023/06/21/0.72-metro-package-exports-symlinks)* [Package Exports Support in React Native](/blog/2023/06/21/package-exports-support)* [React Native 0.71-RC0 Android outage postmortem](/blog/2023/01/27/71rc1-android-outage-postmortem)* [React Native 0.71: TypeScript by Default, Flexbox Gap, and more...](/blog/2023/01/12/version-071)* [First-class Support for TypeScript](/blog/2023/01/03/typescript-first)

                        ##### 2022

                        * [Pointer Events in React Native](/blog/2022/12/13/pointer-events-in-react-native)* [React Native Core Contributor Summit 2022](/blog/2022/11/22/react-native-core-contributor-summit-2022)* [Announcing React Native 0.70](/blog/2022/09/05/version-070)* [Hermes as the Default](/blog/2022/07/08/hermes-as-the-default)* [Announcing React Native 0.69](/blog/2022/06/21/version-069)* [Helping migrate React Native libraries to the New Architecture](/blog/2022/06/16/resources-migrating-your-react-native-library-to-the-new-architecture)* [React Native Accessibility - GAAD 2022 Update](/blog/2022/05/19/GAAD-2022-update)* [Announcing React Native 0.68](/blog/2022/03/30/version-068)* [An update on the New Architecture Rollout](/blog/2022/03/15/an-update-on-the-new-architecture-rollout)* [React Native - H2 2021 Recap](/blog/2022/01/21/react-native-h2-2021-recap)* [Announcing React Native 0.67](/blog/2022/01/19/version-067)

                                            ##### 2021

                                            * [Toward Hermes being the Default](/blog/2021/10/26/toward-hermes-being-the-default)* [Announcing React Native 0.66](/blog/2021/10/01/version-066)* [Preparing Your App for iOS 15 and Android 12](/blog/2021/09/01/preparing-your-app-for-iOS-15-and-android-12)* [React Native Is Hiring Managers, To Expand Beyond Mobile](/blog/2021/08/30/react-native-is-hiring-managers)* [React Native's Many Platform Vision](/blog/2021/08/26/many-platform-vision)* [React Native in H2 2021](/blog/2021/08/19/h2-2021)* [Announcing React Native 0.65](/blog/2021/08/17/version-065)* [The GAAD Pledge - One Year Later](/blog/2021/05/20/GAAD-One-Year-Later)* [The GAAD Pledge - March Accessibility Issues Update](/blog/2021/04/08/GAAD-March-Accessibility-Issue-Update)* [Announcing React Native 0.64 with Hermes on iOS](/blog/2021/03/12/version-0.64)* [The GAAD Pledge - Improving React Native Accessibility](/blog/2021/03/08/GAAD-React-Native-Accessibility)

                                                                ##### 2020

                                                                * [React Native Documentation Update](/blog/2020/07/23/docs-update)* [React Native Team Principles](/blog/2020/07/17/react-native-principles)* [Announcing React Native 0.63 with LogBox](/blog/2020/07/06/version-0.63)* [Announcing React Native 0.62 with Flipper](/blog/2020/03/26/version-0.62)

                                                                      ##### 2019

                                                                      * [Meet Doctor, a new React Native command](/blog/2019/11/18/react-native-doctor)* [Announcing React Native 0.61 with Fast Refresh](/blog/2019/09/18/version-0.61)* [Meet Hermes, a new JavaScript Engine optimized for React Native](/blog/2019/07/17/hermes)* [Announcing React Native 0.60](/blog/2019/07/03/version-60)* [React Native Open Source Update June 2019](/blog/2019/06/12/react-native-open-source-update)* [React Native at F8 and Open Source Podcast](/blog/2019/05/01/react-native-at-f8-and-podcast)* [Releasing React Native 0.59](/blog/2019/03/12/releasing-react-native-059)* [React Native Open Source Update March 2019](/blog/2019/03/01/react-native-open-source-update)* [The State of the React Native Community in 2018](/blog/2019/01/07/state-of-react-native-community)

                                                                                      ##### 2018

                                                                                      * [Open Source Roadmap](/blog/2018/11/01/oss-roadmap)* [Introducing new iOS WebViews](/blog/2018/08/27/wkwebview)* [Accessibility API Updates](/blog/2018/08/13/react-native-accessibility-updates)* [Releasing 0.56](/blog/2018/07/04/releasing-react-native-056)* [State of React Native 2018](/blog/2018/06/14/state-of-react-native-2018)* [Using TypeScript with React Native](/blog/2018/05/07/using-typescript-with-react-native)* [Built with React Native - The Build.com app](/blog/2018/04/09/build-com-app)* [Building <InputAccessoryView> For React Native](/blog/2018/03/22/building-input-accessory-view-for-react-native)* [Using AWS with React Native](/blog/2018/03/05/AWS-app-sync)* [Implementing Twitter’s App Loading Animation in React Native](/blog/2018/01/18/implementing-twitters-app-loading-animation-in-react-native)* [React Native Monthly #6](/blog/2018/01/09/react-native-monthly-6)

                                                                                                          ##### 2017

                                                                                                          * [React Native Monthly #5](/blog/2017/11/06/react-native-monthly-5)* [React Native Monthly #4](/blog/2017/09/21/react-native-monthly-4)* [React Native Monthly #3](/blog/2017/08/30/react-native-monthly-3)* [React Native Performance in Marketplace](/blog/2017/08/07/react-native-performance-in-marketplace)* [React Native Monthly #2](/blog/2017/07/28/react-native-monthly-2)* [React Native Monthly #1](/blog/2017/06/21/react-native-monthly-1)* [Better List Views in React Native](/blog/2017/03/13/better-list-views)* [idx: The Existential Function](/blog/2017/03/13/idx-the-existential-function)* [Introducing Create React Native App](/blog/2017/03/13/introducing-create-react-native-app)* [Using Native Driver for Animated](/blog/2017/02/14/using-native-driver-for-animated)* [A Monthly Release Cadence: Releasing December and January RC](/blog/2017/01/07/monthly-release-cadence)

                                                                                                                              ##### 2016

                                                                                                                              * [Easier Upgrades Thanks to Git](/blog/2016/12/05/easier-upgrades)* [Introducing Button, Faster Installs with Yarn, and a Public Roadmap](/blog/2016/11/08/introducing-button-yarn-and-a-public-roadmap)* [0.36: Headless JS, the Keyboard API, & more](/blog/2016/10/25/0.36-headless-js-the-keyboard-api-and-more)* [Expo Talks: Adam on Unraveling Navigation](/blog/2016/09/08/exponent-talks-unraveling-navigation)* [Right-to-Left Layout Support For React Native Apps](/blog/2016/08/19/right-to-left-support-for-react-native-apps)* [San Francisco Meetup Recap](/blog/2016/08/12/react-native-meetup-san-francisco)* [Toward Better Documentation](/blog/2016/07/06/toward-better-documentation)* [React Native: A year in review](/blog/2016/04/13/react-native-a-year-in-review)* [Dive into React Native Performance](/blog/2016/03/28/dive-into-react-native-performance)* [Introducing Hot Reloading](/blog/2016/03/24/introducing-hot-reloading)

                                                                                                                                                ##### 2015

                                                                                                                                                * [Making React Native apps accessible](/blog/2015/11/23/making-react-native-apps-accessible)* [React Native for Android: How we built the first cross-platform React Native app](/blog/2015/09/14/react-native-for-android)* [React Native: Bringing modern web techniques to mobile](/blog/2015/03/26/react-native-bringing-modern-web-techniques-to-mobile)

Building <InputAccessoryView> For React Native
==============================================

March 22, 2018 · 6 min read

[![Peter Argany](https://avatars3.githubusercontent.com/u/6011080?s=400&u=028e28081107d0ab16a5cb22baca43c080f5fa50&v=4)](https://github.com/PeteTheHeat)

[Peter Argany](https://github.com/PeteTheHeat)

Software Engineer at Facebook

Motivation[​](#motivation "Direct link to Motivation")
------------------------------------------------------

Three years ago, a GitHub issue was opened to support input accessory view from React Native.

![](/blog/assets/input-accessory-1.png)

In the ensuing years, there have been countless '+1s', various workarounds, and zero concrete changes to RN on this issue - until today. Starting with iOS, [we're exposing an API](/docs/inputaccessoryview) for accessing the native input accessory view and we are excited to share how we built it.

Background[​](#background "Direct link to Background")
------------------------------------------------------

What exactly is an input accessory view? Reading [Apple's developer documentation](https://developer.apple.com/documentation/uikit/uiresponder/1621119-inputaccessoryview?language=objc), we learn that it's a custom view which can be anchored to the top of the system keyboard whenever a receiver becomes the first responder. Anything that inherits from `UIResponder` can redeclare the `.inputAccessoryView` property as read-write, and manage a custom view here. The responder infrastructure mounts the view, and keeps it in sync with the system keyboard. Gestures which dismiss the keyboard, like a drag or tap, are applied to the input accessory view at the framework level. This allows us to build content with interactive keyboard dismissal, an integral feature in top-tier messaging apps like iMessage and WhatsApp.

There are two common use cases for anchoring a view to the top of the keyboard. The first is creating a keyboard toolbar, like the Facebook composer background picker.

![](/blog/assets/input-accessory-2.gif)

In this scenario, the keyboard is focused on a text input field, and the input accessory view is used to provide additional keyboard functionality. This functionality is contextual to the type of input field. In a mapping application it could be address suggestions, or in a text editor, it could be rich text formatting tools.

---

The Objective-C UIResponder who owns the `<InputAccessoryView>` in this scenario should be clear. The `<TextInput>` has become first responder, and under the hood this becomes an instance of `UITextView` or `UITextField`.

The second common scenario is sticky text inputs:

![](/blog/assets/input-accessory-3.gif)

Here, the text input is actually part of the input accessory view itself. This is commonly used in messaging applications, where a message can be composed while scrolling through a thread of previous messages.

---

Who owns the `<InputAccessoryView>` in this example? Can it be the `UITextView` or `UITextField` again? The text input is *inside* the input accessory view, this sounds like a circular dependency. Solving this issue alone is [another blog post](https://derpturkey.com/uitextfield-docked-like-ios-messenger/) in itself. Spoilers: the owner is a generic `UIView` subclass who we manually tell to [becomeFirstResponder](https://developer.apple.com/documentation/uikit/uiresponder/1621113-becomefirstresponder?language=objc).

API Design[​](#api-design "Direct link to API Design")
------------------------------------------------------

We now know what an `<InputAccessoryView>` is, and how we want to use it. The next step is designing an API that makes sense for both use cases, and works well with existing React Native components like `<TextInput>`.

For keyboard toolbars, there are a few things we want to consider:

1. We want to be able to hoist any generic React Native view hierarchy into the `<InputAccessoryView>`.
2. We want this generic and detached view hierarchy to accept touches and be able to manipulate application state.
3. We want to link an `<InputAccessoryView>` to a particular `<TextInput>`.
4. We want to be able to share an `<InputAccessoryView>` across multiple text inputs, without duplicating any code.

We can achieve #1 using a concept similar to [React portals](https://reactjs.org/docs/portals.html). In this design, we portal React Native views to a `UIView` hierarchy managed by the responder infrastructure. Since React Native views render as UIViews, this is actually quite straightforward - we can just override:

`- (void)insertReactSubview:(UIView *)subview atIndex:(NSInteger)atIndex`

and pipe all the subviews to a new UIView hierarchy. For #2, we set up a new [RCTTouchHandler](https://github.com/facebook/react-native/blob/master/React/Base/RCTTouchHandler.h) for the `<InputAccessoryView>`. State updates are achieved by using regular event callbacks. For #3 and #4, we use the [nativeID](https://github.com/facebook/react-native/blob/master/React/Views/UIView%2BReact.h#L28) field to locate the accessory view UIView hierarchy in native code during the creation of a `<TextInput>` component. This function uses the `.inputAccessoryView` property of the underlying native text input. Doing this effectively links `<InputAccessoryView>` to `<TextInput>` in their ObjC implementations.

Supporting sticky text inputs (scenario 2) adds a few more constraints. For this design, the input accessory view has a text input as a child, so linking via nativeID is not an option. Instead, we set the `.inputAccessoryView` of a generic off-screen `UIView` to our native `<InputAccessoryView>` hierarchy. By manually telling this generic `UIView` to become first responder, the hierarchy is mounted by responder infrastructure. This concept is explained thoroughly in the aforementioned blog post.

Pitfalls[​](#pitfalls "Direct link to Pitfalls")
------------------------------------------------

Of course not everything was smooth sailing while building this API. Here are a few pitfalls we encountered, along with how we fixed them.

An initial idea for building this API involved listening to `NSNotificationCenter` for UIKeyboardWill(Show/Hide/ChangeFrame) events. This pattern is used in some open-sourced libraries, and internally in some parts of the Facebook app. Unfortunately, `UIKeyboardDidChangeFrame` events were not being called in time to update the `<InputAccessoryView>` frame on swipes. Also, changes in keyboard height are not captured by these events. This creates a class of bugs that manifest like this:

![](/blog/assets/input-accessory-4.gif)

On iPhone X, text and emoji keyboard are different heights. Most applications using keyboard events to manipulate text input frames had to fix the above bug. Our solution was to commit to using the `.inputAccessoryView` property, which meant that the responder infrastructure handles frame updates like this.

---

Another tricky bug we encountered was avoiding the home pill on iPhone X. You may be thinking, “Apple developed [safeAreaLayoutGuide](https://developer.apple.com/documentation/uikit/uiview/2891102-safearealayoutguide?language=objc) for this very reason, this is trivial!”. We were just as naive. The first issue is that the native `<InputAccessoryView>` implementation has no window to anchor to until the moment it is about to appear. That's alright, we can override `-(BOOL)becomeFirstResponder` and enforce layout constraints there. Adhering to these constraints bumps the accessory view up, but another bug arises: ![](/blog/assets/input-accessory-5.gif)

The input accessory view successfully avoids the home pill, but now content behind the unsafe area is visible. The solution lies in this [radar](https://www.openradar.me/34411433). I wrapped the native `<InputAccessoryView>` hierarchy in a container which doesn't conform to the `safeAreaLayoutGuide` constraints. The native container covers the content in the unsafe area, while the `<InputAccessoryView>` stays within the safe area boundaries.

---

Example Usage[​](#example-usage "Direct link to Example Usage")
---------------------------------------------------------------

Here's an example which builds a keyboard toolbar button to reset `<TextInput>` state.

```
class TextInputAccessoryViewExample extends React.Component<  
  {},  
  *,  
> {  
  constructor(props) {  
    super(props);  
    this.state = {text: 'Placeholder Text'};  
  }  
  
  render() {  
    const inputAccessoryViewID = 'inputAccessoryView1';  
    return (  
      <View>  
        <TextInput  
          style={styles.default}  
          inputAccessoryViewID={inputAccessoryViewID}  
          onChangeText={text => this.setState({text})}  
          value={this.state.text}  
        />  
        <InputAccessoryView nativeID={inputAccessoryViewID}>  
          <View style={{backgroundColor: 'white'}}>  
            <Button  
              onPress={() =>  
                this.setState({text: 'Placeholder Text'})  
              }  
              title="Reset Text"  
            />  
          </View>  
        </InputAccessoryView>  
      </View>  
    );  
  }  
}  

```

Another example for [Sticky Text Inputs can be found in the repository](https://github.com/facebook/react-native/blob/84ef7bc372ad870127b3e1fb8c13399fe09ecd4d/RNTester/js/InputAccessoryViewExample.js).

When will I be able to use this?[​](#when-will-i-be-able-to-use-this "Direct link to When will I be able to use this?")
-----------------------------------------------------------------------------------------------------------------------

The full commit for this feature implementation is [here](https://github.com/facebook/react-native/commit/38197c8230657d567170cdaf8ff4bbb4aee732b8). [`<InputAccessoryView>`](/docs/next/inputaccessoryview) will be available in the upcoming v0.55.0 release.

Happy keyboarding :)

**Tags:**

* [engineering](/blog/tags/engineering)

[Newer post

Built with React Native - The Build.com app](/blog/2018/04/09/build-com-app)[Older post

Using AWS with React Native](/blog/2018/03/05/AWS-app-sync)

* [Motivation](#motivation)* [Background](#background)* [API Design](#api-design)* [Pitfalls](#pitfalls)* [Example Usage](#example-usage)* [When will I be able to use this?](#when-will-i-be-able-to-use-this)

Develop

* [Guides](/docs/getting-started)* [Components](/docs/components-and-apis)* [APIs](/docs/accessibilityinfo)* [Architecture](/architecture/overview)

Participate

* [Showcase](/showcase)* [Contributing](/contributing/overview)* [Community](/community/overview)* [Directory](https://reactnative.directory/)* [Stack Overflow](https://stackoverflow.com/questions/tagged/react-native)

Find us

* [Blog](/blog)* [X](https://x.com/reactnative)* [Bluesky](https://bsky.app/profile/reactnative.dev)* [GitHub](https://github.com/facebook/react-native)

Explore More

* [ReactJS](https://react.dev/)* [Privacy Policy](https://opensource.fb.com/legal/privacy/)* [Terms of Service](https://opensource.fb.com/legal/terms/)

[![Meta Open Source Logo](/img/oss_logo.svg)![Meta Open Source Logo](/img/oss_logo.svg)](https://opensource.fb.com/)

Copyright © 2025 Meta Platforms, Inc.